(()=>{var t={913:()=>{Vue.component("fav-btn",{props:{id:{type:String,default:"",required:!0},text:{type:String,default:"",required:!1},active:{type:Boolean,default:!1}},template:'\n    <button class="hover-text focus-text" @click.stop="$emit(\'change\', id, !active)" title="Toggle save favorite station">\n      <span>\n        <i v-if="active" class="ico ico-favs-check text-primary fx fx-drop-in" key="on"></i>\n        <i v-else class="ico ico-favs-add fx fx-drop-in" key="off"></i>\n      </span>\n      <span v-if="text">&nbsp; {{ text }}</span>\n    </button>'})},222:()=>{Vue.filter("toCommas",(function(t,e){var n={style:"decimal",minimumFractionDigits:e,maximumFractionDigits:e};return new Intl.NumberFormat("en-US",n).format(t)})),Vue.filter("toText",(function(t,e){return(t=String(t||"").replace(/[^A-Za-zÀ-ÖØ-öø-ÿ\(\)\`\'\-\,\.\!\?]/g," ").replace(/\s\s+/g," ").trim())||String(e||"")}))},729:(t,e,n)=>{var r=n(149)("jsonp");t.exports=function(t,e,n){"function"==typeof e&&(n=e,e={});e||(e={});var s,a,u=e.prefix||"__jp",c=e.name||u+i++,l=e.param||"callback",h=null!=e.timeout?e.timeout:6e4,f=encodeURIComponent,d=document.getElementsByTagName("script")[0]||document.head;h&&(a=setTimeout((function(){g(),n&&n(new Error("Timeout"))}),h));function g(){s.parentNode&&s.parentNode.removeChild(s),window[c]=o,a&&clearTimeout(a)}return window[c]=function(t){r("jsonp got",t),g(),n&&n(null,t)},t=(t+=(~t.indexOf("?")?"&":"?")+l+"="+f(c)).replace("?&","?"),r('jsonp req "%s"',t),(s=document.createElement("script")).src=t,d.parentNode.insertBefore(s,d),function(){window[c]&&g()}};var i=0;function o(){}},149:(t,e,n)=>{function r(){var t;try{t=e.storage.debug}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t}(e=t.exports=n(666)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))})),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=r,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(r())},666:(t,e,n)=>{var r;function i(t){function n(){if(n.enabled){var t=n,i=+new Date,o=i-(r||i);t.diff=o,t.prev=r,t.curr=i,r=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var i=e.formatters[r];if("function"==typeof i){var o=s[u];n=i.call(t,o),s.splice(u,1),u--}return n})),e.formatArgs.call(t,s),(n.log||e.log||console.log.bind(console)).apply(t,s)}}return n.namespace=t,n.enabled=e.enabled(t),n.useColors=e.useColors(),n.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),"function"==typeof e.init&&e.init(n),n}(e=t.exports=i.debug=i.default=i).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];for(var n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(t=n[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(5),e.names=[],e.skips=[],e.formatters={}},5:t=>{var e=1e3,n=60*e,r=60*n,i=24*r,o=365.25*i;function s(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,a){a=a||{};var u,c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var s=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!s)return;var a=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*o;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(t);if("number"===c&&!1===isNaN(t))return a.long?s(u=t,i,"day")||s(u,r,"hour")||s(u,n,"minute")||s(u,e,"second")||u+" ms":function(t){if(t>=i)return Math.round(t/i)+"d";if(t>=r)return Math.round(t/r)+"h";if(t>=n)return Math.round(t/n)+"m";if(t>=e)return Math.round(t/e)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}(()=>{"use strict";n(222),n(913);const t="";function e(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}const i={getAzuracastHostname:function(){return""!=t?t:window.location.hostname},getChannels:function(t){var e=this,n=this.getAzuracastHostname()+"/api/stations",r="There was a problem fetching the latest list of music channels from AzuraCast.";axios.get(n).then((function(n){var i=e._parseChannels(n.data);return i.length?t(null,i):t(r,[])})).catch((function(e){return t(r+String(e.message||""),[])}))},getSongs:function(t,e){var n=t.songsurl||"",r="There was a problem loading the list of songs for channel "+(t.name||"...")+" from AzuraCast.";axios.get(n).then((function(t){return t.data?e(null,t.data):e(r,[])})).catch((function(t){return e(r+String(t.message||""),[])}))},getNextSongs:function(t,e){var n=t.songsurl||"",r="Station "+(t.name||"...")+" does not support Next Songs from AzuraCast.";axios.get(n).then((function(t){return t.data.playing_next?e(null,t.data):e(r,[])})).catch((function(t){return e(r+String(t.message||""),[])}))},_parseChannels:function(t){var n=[],r=Math.floor(5*Math.random()),i=".png".split("/").pop();if(Array.isArray(t)){var o,s=e(t);try{for(s.s();!(o=s.n()).done;){var a=o.value;a.plsfile=a.playlist_pls_url,a.mp3file=a.listen_url,a.songsurl=this.getAzuracastHostname()+"/api/nowplaying/"+a.id,a.infourl=a.url,a.twitter=a.twitter?"https://twitter.com/@"+a.twitter:"",a.route="/station/"+a.shortcode,a.listeners=0|a.mounts[0].listeners.current,a.updated=0|a.updated,a.favorite=!1,a.active=!1,a.imgLogo=this.getAzuracastHostname()+"/static/uploads/"+a.shortcode+"/album_art."+r+i,n.push(a)}}catch(t){s.e(t)}finally{s.f()}}return n}},o={_context:null,_audio:null,_source:null,_gain:null,_analyser:null,_freq:new Uint8Array(32),_hasfreq:!1,_counter:0,_events:{},setupAudio:function(){var t=this;this._audio&&this._context||(this._audio=new Audio,this._context=new(window.AudioContext||window.webkitAudioContext),this._source=this._context.createMediaElementSource(this._audio),this._analyser=this._context.createAnalyser(),this._gain=this._context.createGain(),this._analyser.fftSize=32,this._source.connect(this._analyser),this._source.connect(this._gain),this._gain.connect(this._context.destination),this._audio.addEventListener("canplay",(function(){t._freq=new Uint8Array(t._analyser.frequencyBinCount),t._audio.play()})),["waiting","playing","ended","stalled","error"].forEach((function(e){t._audio.addEventListener(e,(function(n){return t.emit(e,n)}))})))},on:function(t,e){t&&"function"==typeof e&&(this._events[t]=e)},emit:function(t,e){t&&this._events.hasOwnProperty(t)&&this._events[t](e)},getFreqData:function(t){if(!this._analyser)return 0;this._analyser.getByteFrequencyData(this._freq);var e=Math.floor(0|this._freq[4])/255;return!this._hasfreq&&e&&(this._hasfreq=!0),this._hasfreq?e:(this._counter=t?this._counter<.6?this._counter+.01:this._counter:this._counter>0?this._counter-.01:this._counter,this._counter)},setVolume:function(t){this._gain&&(t=(t=(t=(t=parseFloat(t)||0)>1?t/100:t)>1?1:t)<0?0:t,this._audio.muted=t<=0,this._gain.gain.value=t)},stopAudio:function(){if(this._audio){try{this._audio.pause()}catch(t){}try{this._audio.stop()}catch(t){}try{this._audio.close()}catch(t){}}},playSource:function(t){this.setupAudio(),this.stopAudio(),"suspended"===this._context.state&&this._context.resume().then((function(){console.log("Audio context has been resumed.")})),this._audio.src=String(t||"")+"?x="+Date.now(),this._audio.preload="metadata",this._audio.crossOrigin="anonymous",this._audio.autoplay=!1,this._audio.load()}},s={group:null,shapes:[],move:new THREE.Vector3(0,0,0),touch:!1,ease:8,create:function(t,e){this.group=new THREE.Object3D;for(var n=new THREE.CircleGeometry(1,10),r=new THREE.CircleGeometry(2,20),i=new THREE.SphereGeometry(100,30,14).vertices,o=new THREE.MeshNormalMaterial({transparent:!0,opacity:0,side:THREE.DoubleSide}),s=new THREE.Vector3(0,0,0),a=0;a<i.length;a++){var u=i[a],c=u.x,l=u.y,h=u.z,f={x:c,y:l,z:h},d=THREE.Math.randInt(0,100),g=THREE.Math.randInt(10,30),p=new THREE.Mesh(a%2?n:r,o);p.position.set(c,l,h),p.lookAt(s),p.userData={radius:12,cycle:d,pace:g,home:f},this.group.add(p)}this.touch="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,this.group.position.set(40,5,0),this.group.rotation.x=Math.PI/2+.6,e.add(this.group)},update:function(t,e,n){var r=t.width<800?0:40,i=t.width<800?-60:20,o=.5+.5*n;this.touch?this.group.position.x=r:(this.move.x=r+-.012*e.x,this.group.position.x+=(this.move.x-this.group.position.x)/this.ease,this.group.position.y+=(this.move.y-this.group.position.y)/this.ease),this.group.position.z=i+80*n,this.group.rotation.y-=.003;for(var s=0;s<this.group.children.length;s++){var a=this.group.children[s],u=a.userData,c=u.radius,l=u.cycle,h=u.pace,f=u.home;a.material.opacity=.2+.8*n,a.position.set(f.x,f.y,f.z),a.translateZ(o*Math.sin(l/h)*c),a.userData.cycle++}}};function a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return u(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}const c={_wrap:null,_canvas:null,_renderer:null,_scene:null,_camera:null,_box:null,_mouse:{x:0,y:0},_objects:[],setupCanvas:function(){this._wrap=document.querySelector("#player-wrap"),this._canvas=document.querySelector("#player-canvas"),this._box=this._wrap.getBoundingClientRect(),this._scene=new THREE.Scene,this._renderer=new THREE.WebGLRenderer({canvas:this._canvas,alpha:!0,antialias:!0,precision:"lowp"}),this._renderer.setClearColor(0,0),this._renderer.setPixelRatio(window.devicePixelRatio),this._camera=new THREE.PerspectiveCamera(60,this._box.width/this._box.height,.1,2e4),this._camera.lookAt(this._scene.position),this._camera.position.set(0,0,300),this._camera.rotation.set(0,0,0),this._objects.push(s);var t,e=a(this._objects);try{for(e.s();!(t=e.n()).done;){t.value.create(this._box,this._scene)}}catch(t){e.e(t)}finally{e.f()}window.addEventListener("mousemove",this.updateMouse.bind(this)),window.addEventListener("resize",this.updateSize.bind(this)),this.updateMouse(),this.updateSize()},updateObjects:function(t){var e,n=a(this._objects);try{for(n.s();!(e=n.n()).done;){e.value.update(this._box,this._mouse,t)}}catch(t){n.e(t)}finally{n.f()}this._renderer.render(this._scene,this._camera)},updateSize:function(){this._wrap&&this._canvas&&(this._box=this._wrap.getBoundingClientRect(),this._canvas.width=this._box.width,this._canvas.height=this._box.height,this._camera.aspect=this._box.width/this._box.height,this._camera.updateProjectionMatrix(),this._renderer.setSize(this._box.width,this._box.height))},updateMouse:function(t){if(this._box){var e=this._box.left+this._box.width/2,n=this._box.top+this._box.height/2;t?(this._mouse.x=Math.max(0,t.pageX||t.clientX||0)-e,this._mouse.y=Math.max(0,t.pageY||t.clientY||0)-n):(this._mouse.x=e,this._mouse.y=n)}}},l=function(t,e,n){var r=new RegExp("^("+n+")","i");return t.filter((function(t){return r.test(t[e])}))},h=function(t,e,n,r){return t.sort((function(t,i){if(t.hasOwnProperty(e)){var o=t[e],s=i[e];if(r&&(o="string"==typeof o?o.toUpperCase():o,s="string"==typeof s?s.toUpperCase():s),"asc"===n){if(o<s)return-1;if(o>s)return 1}if("desc"===n){if(o>s)return-1;if(o<s)return 1}}return 0}))},f={set:function(t,e,n){if(this._isStr(t)){var r=Date.now(),i=Number(n)||0,o=JSON.stringify({time:r,expire:i,data:e});window.localStorage.setItem(t,o)}},get:function(t){if(this._isStr(t)){var e=window.localStorage.getItem(t)||"{}",n=JSON.parse(e)||{},r=n.time,i=n.expire,o=n.data;return this._isExpired(r,i)&&this.delete(t),o}},delete:function(t){this._isStr(t)&&window.localStorage.removeItem(t)},_isStr:function(t){return t&&"string"==typeof t},_isExpired:function(t,e){return!(!t||!e)&&(Date.now()-t)/1e3>=e}};function d(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return g(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}new Vue({el:"#app",data:{init:!1,visible:!0,playing:!1,loading:!1,sidebar:!1,volume:80,sbActive:!1,sbVisible:!1,route:"/",stations:[],station:{},songHist:[],songNow:{},nextSong:{},nextPlay:{},image:{},itunes:{},nextitunes:{},currentsong:{},favorites:[],errors:{},timeStart:0,timeDisplay:"00:00:00",timeItv:null,searchText:"",sortParam:"listeners",sortOrder:"desc",anf:null,sto:null,itv:null},watch:{playing:function(){this.playing?this.startClock():this.stopClock()},volume:function(){o.setVolume(this.volume)}},computed:{channelsList:function(){var t=this,e=this.stations.slice(),n=this.searchText.replace(/[^\w\s\-]+/g,"").replace(/[\r\s\t\n]+/g," ").trim();return n&&n.length>1&&(e=l(e,"name",n)),this.sortParam&&(e=h(e,this.sortParam,this.sortOrder,!1)),this.station.shortcode&&(e=e.map((function(e){return e.active=t.station.shortcode===e.shortcode,e}))),e},songsList:function(){return this.songHist.slice()},sortLabel:function(){switch(this.sortParam){case"name":return"Station Name";case"listeners":return"Listeners Count";case"favorite":return"Saved Favorites";case"genre":return"Music Genre"}},canPlay:function(){return!(!this.station.shortcode||this.loading)},hasChannel:function(){return!!this.station.shortcode},hasSongs:function(){return!!this.songHist.length},hasNextSong:function(){return!!this.nextSong.title},hasErrors:function(){return!(!this.errors.support&&!this.errors.stream)||!(!this.errors.stations||this.stations.length)}},methods:{setupMaintenance:function(){var t=this;this.itv=setInterval((function(){t.getChannels(t.sidebar),t.getSongs(t.station)}),3e4)},setError:function(t,e){var n=Object.assign({},this.errors);n[t]=String(e||"").trim(),e&&console.warn("ERROR("+t+"):",e),this.errors=n},clearError:function(t){var e=Object.assign({},this.errors);delete e[t],this.errors=e},hasError:function(t){return t&&this.errors.hasOwnProperty(t)},flushErrors:function(){this.errors={}},setupEvents:function(){var t=this;document.addEventListener("visibilitychange",(function(){t.visible="visible"===document.visibilityState})),window.addEventListener("hashchange",(function(){return t.applyRoute(window.location.hash)})),window.addEventListener("keydown",this.onKeyboard),o.on("waiting",this.onWaiting),o.on("playing",this.onPlaying),o.on("ended",this.onEnded),o.on("error",this.onError)},initPlayer:function(){var t=this;setTimeout((function(){document.querySelector("#_spnr").style.display="none",document.querySelector("#player-wrap").style.opacity="1",t.init=!0}),100)},resetPlayer:function(){this.closeAudio(),this.flushErrors(),this.station={},this.songHist=[]},tryAgain:function(){this.hasError("support")?(this.flushErrors(),setTimeout(this.setupAudio,1)):(this.flushErrors(),this.playChannel(this.station))},apiBaseUrl:function(){return""!=t?t:window.location.hostname},toggleSidebar:function(t){var e=this;"boolean"==typeof t&&t?(this.sbActive=!0,this.sbVisible=!0,this.$refs.sidebarDrawer.focus()):(this.sbVisible=!1,setTimeout((function(){e.sbActive=!1}),500))},togglePlay:function(t){if(t&&t.preventDefault(),!this.loading)return this.playing?this.closeAudio():void this.playChannel(this.station)},saveVolume:function(){f.set("player_volume",this.volume)},loadVolume:function(){var t=parseInt(f.get("player_volume"))||80;this.volume=t},loadSortOptions:function(){var t=f.get("sorting_data");t&&t.param&&(this.sortParam=t.param),t&&t.order&&(this.sortOrder=t.order)},toggleSortOrder:function(){this.sortOrder="asc"===this.sortOrder?"desc":"asc"},sortBy:function(t,e){this.sortParam===t?this.toggleSortOrder():this.sortOrder=e||"asc",this.sortParam=t,f.set("sorting_data",{param:this.sortParam,order:this.sortOrder})},loadFavorites:function(){var t=f.get("favorites_data");Array.isArray(t)&&(this.favorites=t)},saveFavorites:function(){var t,e=this,n="#EXTM3U",r=d(this.favorites);try{var i=function(){var r=t.value,i=e.stations.filter((function(t){return t.shortcode===r})).shift();if(!i)return 1;n+="\n\n",n+="#EXTINF:0,".concat(i.title," [AzuraCast]\n"),n+="".concat(i.mp3file)};for(r.s();!(t=r.n()).done;)i()}catch(t){r.e(t)}finally{r.f()}var o=document.createElement("a");o.setAttribute("href","data:audio/mpegurl;charset=utf-8,"+encodeURIComponent(n)),o.setAttribute("download","azuracast_favorites.m3u"),o.setAttribute("target","_blank"),document.body.appendChild(o),setTimeout((function(){return o.click()}),100),setTimeout((function(){return o.remove()}),1e3)},toggleFavorite:function(t,e){var n=this.favorites.slice();n=n.filter((function(e){return e!==t})),e&&n.push(t),this.favorites=n,this.updateCurrentChannel(),f.set("favorites_data",n)},closeAudio:function(){o.stopAudio(),this.playing=!1},setupCanvas:function(){c.setupCanvas()},updateCanvas:function(){if(this.anf=requestAnimationFrame(this.updateCanvas),this.visible){var t=o.getFreqData(this.playing);c.updateObjects(t)}},getChannels:function(t){var e=this;i.getChannels((function(n,r){if(n)return e.setError("stations",n);e.stations=r,e.clearError("stations"),e.updateCurrentChannel(),e.applyRoute(window.location.hash,t)}))},getSongs:function(t,e){var n=this;t&&t.shortcode&&t.songsurl&&(this.isCurrentChannel(t)||(this.songHist=[],this.songNow={},this.currentsong={},this.image={}),i.getSongs(t,(function(t,r){if(t)return n.setError("songs",t);"function"==typeof e&&e(r),n.songNow=r.now_playing.song,n.currentsong=r.now_playing,n.songHist=r.song_history,n.image=r.now_playing.song,n.clearError("songs");var i=n.currentsong.song.text;n.getCover(i)})))},getCover:function(t){var e=this,r=n(729);this.itunes={},r("https://itunes.apple.com/search?term=="+encodeURIComponent(t)+"&media=music&limit=1",(function(t,n){if(t)e.image,console.log("%c Cover not found, Get default from server","background: red; color: white;");else if(1==n.results.length){var r=n.results[0].artworkUrl100.replace("100x100","512x512");e.itunes={cover:r}}}))},getNextSongs:function(t,e){var n=this;t&&t.shortcode&&t.songsurl&&(this.isCurrentChannel(t)||(this.nextSong={},this.nextPlay={}),i.getNextSongs(t,(function(t,r){if(t)return n.nextPlay.played_at=0,"function"==typeof e&&e(r),void console.log("%c This station doesn't support next song","background: red; color: white");"function"==typeof e&&e(r),n.nextSong=r.playing_next.song,n.nextPlay=r.playing_next;var i=n.nextSong.text;n.getNextCover(i)})))},getNextCover:function(t){var e=this,r=n(729);this.nextitunes={},r("https://itunes.apple.com/search?limit=1&term=".concat(encodeURIComponent(t)),(function(t,n){if(t)e.nextSong,console.log("%c Cover Next song not found, Get default from server","background: red; color: white;");else if(1==n.results.length){var r=n.results[0].artworkUrl100.replace("100x100","512x512");e.nextitunes={cover:r}}}))},isCurrentChannel:function(t){return!!(t&&t.shortcode&&this.station.shortcode)&&this.station.shortcode===t.shortcode},updateCurrentChannel:function(){var t,e=d(this.stations);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.favorite=this.favorites.indexOf(n.shortcode)>=0,this.isCurrentChannel(n)&&(this.station=Object.assign(this.station,n),n.active=!0)}}catch(t){e.e(t)}finally{e.f()}},playChannel:function(t){!this.playing&&t&&t.mp3file&&(this.loading=!0,o.playSource(t.mp3file),o.setVolume(this.volume))},selectChannel:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&t.shortcode&&(this.isCurrentChannel(t)||(this.closeAudio(),this.toggleSidebar(!1),this.setRoute(t.route),this.getSongs(t),this.getNextSongs(t),this.station=t,e&&this.playChannel(t)))},setRoute:function(t){t="/"+String(t||"").replace(/^[\#\/]+|[\/]+$/g,"").trim(),window.location.hash=t,this.route=t},applyRoute:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=String(t||"").replace(/^[\#\/]+|[\/]+$/g,"").trim().split("/"),r=n.length?n.shift():"",i=n.length?n.shift():"";if("station"===r&&i){var o=this.stations.filter((function(t){return t.shortcode===i})).shift();if(o&&o.shortcode)return this.selectChannel(o)}this.closeAudio(),this.resetPlayer(),this.toggleSidebar(e)},onKeyboard:function(t){var e=t.key||"";return" "===e&&this.station.shortcode?this.togglePlay():"Enter"===e?this.toggleSidebar(!0):"Escape"===e?this.toggleSidebar(!1):void 0},onWaiting:function(t){var e=this;this.sto&&clearInterval(this.sto),this.sto=setTimeout((function(){return e.onError(t)}),1e4),this.playing=!1,this.loading=!0},onPlaying:function(){this.clearError("stream"),this.playing=!0,this.loading=!1},onEnded:function(){this.playing=!1,this.loading=!1},onError:function(t){this.closeAudio(),this.setError("stream","The selected stream (".concat(this.station.title,") could not load, or stopped loading due to network problems.")),this.playing=!1,this.loading=!1,console.log("%c Errot => "+t.message)},startClock:function(){this.stopClock(),this.timeStart=Date.now(),this.timeItv=setInterval(this.updateClock,1e3),this.updateClock()},updateClock:function(){var t=function(t){return t<10?"0"+t:""+t},e=(Date.now()-this.timeStart)/1e3,n=Math.floor(e%60),r=Math.floor(e/60%60),i=Math.floor(e/3600);this.timeDisplay=t(i)+":"+t(r)+":"+t(n)},stopClock:function(){this.timeItv&&clearInterval(this.timeItv),this.timeItv=null},clearTimers:function(){this.sto&&clearTimeout(this.sto),this.itv&&clearInterval(this.itv),this.anf&&cancelAnimationFrame(this.anf)},getPlayAt:function(t){var e=new Date(1e3*t);e.toLocaleString(),e.toDateString(),e.toLocaleTimeString();return e.toLocaleTimeString("en-us",{hour:"2-digit",minute:"2-digit"})},setCssHeight:function(t,e){t.style.setProperty("--height","".concat(e,"px"))},updateHeight:function(){var t=this,e=document.querySelector(":root");this.setCssHeight(e,window.innerHeight),window.addEventListener("resize",(function(n){return t.setCssHeight(e,window.innerHeight)}))}},mounted:function(){this.loadSortOptions(),this.loadFavorites(),this.loadVolume(),this.setupEvents(),this.getChannels(!0),this.setupCanvas(),this.updateCanvas(),this.setupMaintenance(),this.updateHeight(),this.initPlayer()},destroyed:function(){this.closeAudio(),this.clearTimers()}})})()})();